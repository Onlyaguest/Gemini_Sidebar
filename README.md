# Gemini Prompt Sidebar

一个用于 Gemini 网页版的 Chrome 扩展：在页面右侧注入侧边栏，按分组点击即可把预设提示词插入输入框。

## 功能

- 侧边栏分组管理预设提示词，会议记录处理流程默认展开
- 支持模板变量（如 `{{notes}}`），点击后弹窗补全
- 支持参考文档引用（`{{ref}}` / `{{who_ref}}`）
- 会议记录处理流程含“生成交付卡片”与“推送到 Obsidian”
- 「辅助小工具」分组：参考文档 / 对话导出 / 自由框（默认收起）
- 自由框支持临时记录与“固化”保存，一键插入输入框
- 一键导出当前对话为 Markdown（全部消息 / 仅我方提问）
- 侧边栏可拖动位置（拖动顶部区域或 Prompts 按钮）

## 安装与使用

1. 打开 Chrome 扩展管理页：`chrome://extensions/`
2. 开启「开发者模式」
3. 点击「加载已解压的扩展程序」并选择本目录：`tasks/gemini-prompt-sidebar`
4. 打开 Gemini 网页版：`https://gemini.google.com/`
5. 点击浏览器工具栏的扩展图标，侧边栏会出现
6. 在右侧侧边栏点击预设即可插入到输入框
7. 在「会议记录处理」第 6 步可推送最后一条回复到 Obsidian Draft
8. 在「辅助小工具」中进行参考文档导入 / 对话导出 / 自由框使用

## 配置与编辑

- 预设内容在 `presets.js` 中维护（按分组定义）。
- 模板变量写成 `{{变量名}}`，点击后会逐个弹窗填写。
- 写作类模板支持 `{{persona}}` 作为账号人设卡片变量。
- 使用 `{{ref}}`（会议）与 `{{who_ref}}`（人物）可直接插入已导入的参考文档内容。
- 参考文档支持“从剪贴板导入”，无需反复打开文件。
- Obsidian 推送目标在 `content.js` 的 `OBSIDIAN_VAULT` / `OBSIDIAN_FOLDER` 中配置（默认 `ViviNotes/Draft`）。

### 自由框（临时/固化）

- 默认是临时缓存（浏览器会话级）
- 点击「固化」后会长期保存，再次点击可解除固化
- 点击「插入到输入框」可直接把自由框内容插入 Gemini
- 支持收起/展开，默认收起，避免影响常用预设区域

可选校验：

```bash
node index.js
```

## 常见问题

- 插入失败：先点击一次 Gemini 的输入框，再点击侧边栏预设。
- 想折叠侧边栏：点击侧边栏顶部的「Prompts」按钮即可收起/展开，或再次点击扩展图标。
- 想隐藏整个浮窗：点击「Prompts」按钮右上角的 ×，需要时再点扩展图标重新显示。
- 侧边栏不出现：在扩展页点击「重新加载」，再刷新 Gemini 页面。
- 导出内容不完整：先滚动页面，确保当前对话历史已加载完成。
- 参考文档为空：请先在「参考文档」里选择本地 Markdown 文件。
- 推送到 Obsidian 无反应：确认 Obsidian 已打开并允许浏览器打开外部应用。

## 文件说明

- `manifest.json`: Chrome 扩展入口
- `content.js`: 注入侧边栏与插入逻辑
- `sidebar.css`: 侧边栏样式
- `presets.js`: 预设分组与模板
- `index.js`: 预设结构校验脚本
